import pickle
import sys
from typing import Any


def put(target: int, msg: Any):
    serialized_obj = pickle.dumps(msg)
    num_bytes = len(serialized_obj)
    num_bytes = num_bytes.to_bytes(4, "big")
    target = target.to_bytes(4, "big")
    flag = B"\x02"
    result = flag + target + num_bytes + serialized_obj
    sys.stdout.buffer.write(result)


def get(source: int) -> Any:
    flag = B"\x03"
    source = source.to_bytes(4, "big")
    get_instruction = flag + source
    sys.stdout.buffer.write(get_instruction)

    a_byte_i_hope = sys.stdin.read(1)
    return f"I read {type(a_byte_i_hope)}: {a_byte_i_hope}"
    # four_bytes_i_hope = sys.stdin.buffer.read(4)
    # length = int.from_bytes(four_bytes_i_hope, "big")
    # for i in range(length):
    #     sys.stdin.buffer.read(4)
    # return length
